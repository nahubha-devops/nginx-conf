apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-admin-vhost
  namespace: nginx
data:
  # SHARED UPSTREAMS
  shared-upstreams.conf: |
    upstream iot_web { server iot-web.apps.svc.cluster.local:80; }
    upstream admin_web { server admin-web.apps.svc.cluster.local:80; }
    upstream gateway { server rinoiot-gateway.apps.svc.cluster.local:8100; }
    upstream xxl_job { server xxl-job-admin.apps.svc.cluster.local:8080; }
    upstream nacos { server nacos.nacos.svc.cluster.local:8848; }
    upstream rmqdash { server rocketmq-dashboard.rocketmq.svc.cluster.local:8080; }
    upstream openapi { server rinoiot-openapi.apps.svc.cluster.local:8400; }
    upstream developer_docs { server rinoiot-developer-docs.apps.svc.cluster.local:80; }
    upstream mqtt_broker { server mqtt-broker.mqtt.svc.cluster.local:1883; }
    upstream mqtt_auth { server rinoiot-provider-mqtt-access.apps.svc.cluster.local:8106; }
    upstream websocket { server rinoiot-provider-push.apps.svc.cluster.local:8107; }
    upstream wsmqtt { server rinoiot-provider-mqtt-access.apps.svc.cluster.local:1893; }
    upstream search { server rinoiot-business-support.apps.svc.cluster.local:8451; }
    upstream support { server rinoiot-business-support.apps.svc.cluster.local:8451; }
    upstream product_testing { server rinoiot-product-testing.apps.svc.cluster.local:8899; }
    upstream cerebro { server cerebro.elasticsearch.svc.cluster.local:19000; }
    upstream h5_web { server h5-web.apps.svc.cluster.local:80; }
    upstream docs_web { server rinoiot-developer-docs.apps.svc.cluster.local:80; }
    upstream integ_web { server integ-web.apps.svc.cluster.local:80; }
    upstream product-management { server product-management.apps.svc.cluster.local:8301; }

  staging-iot.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-iot.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location / { proxy_pass http://iot_web; } location /api/ { add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token,language,app_id,client_id,os_name,rino_source,encrypt_type'; if ($request_method = 'OPTIONS') { return 204; } proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://gateway/; } location /websocket/server { proxy_pass http://websocket; proxy_http_version 1.1; proxy_connect_timeout 4s; proxy_read_timeout 3600s; proxy_send_timeout 12s; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection "upgrade"; } location /xxl-job-admin { proxy_pass http://xxl_job; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } location /nacos { proxy_pass http://nacos; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } location ~ ^/webConfig.json { default_type application/json; return 200 '{"deviceLogSearchApiReplaceMap": { "iot-test.yijian.store": "search-test.yijian.store" }}'; } }
  staging-admin.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-admin.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location / { proxy_pass http://admin_web; } location /api/ { add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token'; if ($request_method = 'OPTIONS') { return 204; } proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://gateway/; } }
  staging-nacos.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-nacos.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header 'Access-Control-Allow-Origin' '*' always; location / { proxy_pass http://nacos; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } }
  staging-rmqdashboard.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-rmqdashboard.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization'; location / { proxy_pass http://rmqdash; } }
  staging-mqtt.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-mqtt.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location / { proxy_pass http://wsmqtt; proxy_http_version 1.1; proxy_connect_timeout 4s; proxy_read_timeout 3600s; proxy_send_timeout 12s; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection "upgrade"; } }
  staging-docs.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-docs.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token'; location / { proxy_pass http://docs_web; } }
  staging-openapi.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-openapi.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location ~ /\.(?!well-known) { deny all; } location = /favicon.ico { log_not_found off; access_log off; } location = /robots.txt { log_not_found off; access_log off; } location / { add_header 'Access-Control-Allow-Origin' '*'; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' '*'; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; if ($request_method = 'OPTIONS') { return 200; } proxy_pass http://openapi/platform/; } }
  staging-search.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-search.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization,language,app_id,client_id,os_name'; location / { proxy_pass http://search; proxy_http_version 1.1; proxy_connect_timeout 4s; proxy_read_timeout 3600s; proxy_send_timeout 12s; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection "upgrade"; } }
  staging-support.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-support.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization,language,app_id,client_id,os_name'; location / { proxy_pass http://support; proxy_http_version 1.1; proxy_connect_timeout 4s; proxy_read_timeout 3600s; proxy_send_timeout 12s; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection "upgrade"; } }
  staging-cerebro.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-cerebro.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization'; location / { proxy_pass http://cerebro; } }
  staging-h5.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-h5.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization'; location / { proxy_pass http://h5_web; } }
  staging-integration.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-integration.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token'; rewrite ^(/rino-smart-download)$ /rino-smart-download.html redirect; rewrite ^(/connectAlexa)$ /connectAlexa.html redirect; rewrite ^(/connectAlexaEn)$ /connectAlexaEn.html redirect; rewrite ^(/connectAlexaZh)$ /connectAlexaZh.html redirect; rewrite ^(/download)$ /download.html redirect; rewrite ^(/googleAssistant)$ /googleAssistant.html redirect; rewrite ^(/googleAssistantEn)$ /googleAssistantEn.html redirect; rewrite ^(/googleAssistantZh)$ /googleAssistantZh.html redirect; location / { proxy_pass http://integ_web; } }
  staging-product-testing.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-product-testing.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location / { add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token'; if ($request_method = 'OPTIONS') { return 204; } proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://product_testing; } }
  staging-susus7rwpd8wlv9b9-link.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-susus7rwpd8wlv9b9.link.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token'; location / { rewrite ^/(.*)$ /business-app/v1/short/link/request/$1 break; proxy_pass http://gateway; } }
  staging-tcp.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-tcp.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location / { proxy_pass http://gateway; proxy_set_header Host $host; } }
  staging-kibana.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-kibana.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location / { proxy_pass http://kibana.elasticsearch.svc.cluster.local:5601; proxy_set_header Host $host; } }
  staging-nfc.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-nfc.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization'; rewrite ^(/rino-smart-download)$ /rino-smart-download.html redirect; rewrite ^(/connectAlexa)$ /connectAlexa.html redirect; rewrite ^(/connectAlexaEn)$ /connectAlexaEn.html redirect; rewrite ^(/connectAlexaZh)$ /connectAlexaZh.html redirect; rewrite ^(/download)$ /download.html redirect; rewrite ^(/googleAssistant)$ /googleAssistant.html redirect; rewrite ^(/googleAssistantEn)$ /googleAssistantEn.html redirect; rewrite ^(/googleAssistantZh)$ /googleAssistantZh.html redirect; location / { proxy_pass http://h5_web; } location /.well-known/assetlinks.json { default_type application/json; return 200 '[{"relation":["delegate_permission/common.handle_all_urls"],"target":{"namespace":"android_app","package_name":"com.smart.protcoiot","sha256_cert_fingerprints":["AE:EE:74:B1:C7:90:FB:30:81:E5:BC:03:C4:5F:67:31:08:15:0D:70:A2:CA:0B:80:07:76:49:60:C7:B8:49:EC"]}},{"relation":["delegate_permission/common.get_login_creds"],"target":{"namespace":"web","site":"https://nfc.protco.in/alexa"}},{"relation":["delegate_permission/common.get_login_creds"],"target":{"namespace":"android_app","package_name":"com.smart.protcoiot","sha256_cert_fingerprints":["AE:EE:74:B1:C7:90:FB:30:81:E5:BC:03:C4:5F:67:31:08:15:0D:70:A2:CA:0B:80:07:76:49:60:C7:B8:49:EC"]}}]'; } location /.well-known/apple-app-site-association { default_type application/json; return 200 '{"applinks":{"apps":[],"details":[{"appID":"95FK4N3CC4.com.smart.protcoiot","paths":["*"]}]},"webcredentials":{"apps":["com.smart.protcoiot"]}}'; } }
  staging-pulsar.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-pulsar.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; location / { proxy_pass http://pulsar-manager.pulsar.svc.cluster.local:9527; proxy_set_header Host $host; } }
  staging-s.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-s.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token'; location / { rewrite ^/(.*)$ /business-app/v1/short/link/request/$1 break; proxy_pass http://gateway; } }
  staging-service.conf: |
    server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name staging-service.protco.in; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; ssl_protocols TLSv1.2 TLSv1.3; add_header X-XSS-Protection "1; mode=block" always; add_header X-Content-Type-Options "nosniff" always; add_header Referrer-Policy "no-referrer-when-downgrade" always; add_header Permissions-Policy "interest-cohort=()" always; add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always; add_header 'Access-Control-Allow-Origin' '*' always; add_header 'Access-Control-Allow-Methods' 'PUT, GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Auth-Token,language,app_id,client_id,os_name,version,devid,ua,package_name,rino_source,encrypt_type'; location /api/ { if ($request_method = 'OPTIONS') { return 204; } proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://gateway/; } }
  default.conf: |
    server { listen 443 ssl http2 default_server; listen [::]:443 ssl http2 default_server; server_name _; http2 on; ssl_certificate /etc/nginx/ssl/tls.crt; ssl_certificate_key /etc/nginx/ssl/tls.key; return 404; }
